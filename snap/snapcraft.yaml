name: merkaartor
base: core24
version: '0.20.0'
summary: An OpenStreetMap editor
description: |
  Merkaartor is an OpenStreetMap editor for Linux, macOS and Windows.

grade: stable
confinement: strict
license: GPL-2.0
compression: lzo

parts:
  merkaartor:
    plugin: cmake
    source: https://github.com/openstreetmap/merkaartor.git
    source-commit: f55c5669b96bc5fa7ee309f3bd9145fb3c70d521 # 0.20.0
    cmake-parameters:
      - -DZBAR=ON
      - -DGPSD=OFF
      - -DWEBENGINE=ON
      - -DEXTRA_TESTS=OFF
      - -DCMAKE_BUILD_TYPE=Release
      - -DQT_MAJOR_VERSION=6
      - -DBUILD_WITH_QT6=ON
    build-snaps:
      - cmake
    build-packages:
      - build-essential
      - libgdal-dev
      - libproj-dev
      - libexiv2-dev
      - libzbar-dev
      - libprotobuf-dev
      - protobuf-compiler
    stage-packages:
      - libarmadillo12
      - libhdf4-0-alt
      - libgdal34t64
      - libogdi4.1
      - libaec0
      - libarpack2t64
      - libblas3
      - libblosc1
      - libcfitsio10t64
      - libcharls2
      - libcurl4t64
      - libde265-0
      - libfreexl1
      - libfyba0t64
      - libgeos-c1t64
      - libgeos3.12.1t64
      - libgeotiff5
      - libgfortran5
      - libgif7
      - libhdf5-103-1t64
      - libhdf5-hl-100t64
      - libheif1
      - libkmlbase1t64
      - libkmldom1t64
      - libkmlengine1t64
      - liblapack3
      - libnetcdf19t64
      - libodbcinst2
      - libpoppler134
      - libproj25
      - libqhull-r8.0
      - libquadmath0
      - librttopo1
      - libspatialite8t64
      - libsuperlu7
      - libsz2
      - liburiparser1
      - libxerces-c3.2
      - libzbar0
      - libprotobuf32
    organize:
      usr/lib/*-linux-gnu/blas/*: usr/lib/
      usr/lib/*-linux-gnu/lapack/*: usr/lib/

layout:
  /usr/local/lib/merkaartor/plugins:
    symlink: $SNAP/usr/local/lib/merkaartor/plugins

apps:
  merkaartor:
    command: usr/local/bin/merkaartor
    plugs:
      - network
      - home
      - unity7
      - removable-media
      - network-manager-observe
      - cups
      - avahi-control
      - network-manager
    extensions: [kde-neon]

